sudo: required
matrix:
  fast_finish: true
services:
- docker
before_install:
- docker pull muccg/ccg-composer
script:
- echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
- chmod 755 ~/.docker
- chmod 644 ~/.docker/config.json
- export "GIT_BRANCH=$TRAVIS_BRANCH"
- test x"$TRAVIS_PULL_REQUEST_BRANCH" != x"" && export "GIT_BRANCH=$TRAVIS_PULL_REQUEST_BRANCH" || echo "This build is not a PR."
- export "BRANCH_NAME=$GIT_BRANCH"
- ./travis-build.sh
- ./travis-prodbuild.sh

env:
  global:
    - DOCKER_USERNAME: ccgbuildbot
    - secure: "BBwqQqmuueP6lseUanI1bahcbEyGowwN4rlLnieFxdrQY0UDCC8i3FffH54masCeR8iGD2mx7dNGVlfKYE8D4Vn9V3dQom9fdoKCrkGy2iNRynBDOYBR/SzG20V2bFqOYL68cYRLqTB9BmiQkyF1gk0LW045NxQ5HjByk13RUb2oss8RPDqOpwJZFt7jlipjxWVngVFpMbnxQDMVYvpytW9z7MaHhmhVEg29jum1Nxt2ue/ngkOSyufDNwiVgdzlYqoDGX2Ps1On8GRACkmiqFQ7len3y51I6BuBBDoK7PcQJlxZoKp1ixT9GKttn0nLamjOwU3uKp/M0UoUwc0MNkRXe2Z65/I9N+TMBGbgOYxxXcarNzJHPv8jAjE/uqXDRcoEt8OsZqZ3WP6tS50Ve+j18NVI6BFVBuRxzB2TfUWNbsFxpQ0lm5XH6ldkrlAhMGrXImpsYgADIuJCX+n1AXv6knFEDU/L+KjHJ00zCE2nfHoLWIYxEw7OFmkus2o+gLOvqvvF8dzKketIBcOqSrb+uGvLBjhCwY92eIJtRv30G51e9jQgzl0NpC6MLDip1WedEhrTvxXnlojdyWxs8qPIV/VIs6XbS0q+I9fxWS0ZrvyUjwHaQZskHzID+Nkj3OYNXPdxkEZl4ZYZMRbSmg5ra5l9P9IxY0boRaXWG5Y="
